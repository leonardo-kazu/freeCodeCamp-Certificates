<!DOCTYPE html>
<html>
  <head>
    <title>Issue Tracker</title>
    <link
      rel="icon"
      type="image/png"
      href="https://cdn.freecodecamp.org/universal/favicons/favicon-16x16.png"
    />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="../public/style.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
  </head>
  <body class="bg-light">
    <header class="mt-2 mb-2 text-bg-light">
      <h1 class="container display-1">Issue Tracker</h1>
    </header>

    <hr class="container" />

    <section class="container mt-2">
      <form id="testForm" class="row g-3">
        <div class="col-12">
          <label for="basic-url" class="form-label display-6">Submit issue to a project:</label>
          <div class="input-group">
            <span class="input-group-text" id="basic-addon3"></span>
            <input
              type="text"
              class="form-control"
              id="basic-url"
              name="project"
              aria-describedby="basic-addon3"
              placeholder="project's name"
              required
            />
          </div>
          <div class="form-text">Go to /{project} to see all issues.</div>
        </div>

        <div class="col-12 mb-3">
          <input
            type="text"
            class="form-control"
            name="issue_title"
            placeholder="*Title"
            required
          />
        </div>

        <div class="col-md-6 mb-3">
          <div class="input-group">
            <span class="input-group-text">@</span>
            <input
              type="text"
              name="created_by"
              placeholder="*Created by:"
              required
              class="form-control"
            />
          </div>
        </div>

        <div class="col-md-6">
          <div class="input-group">
            <span class="input-group-text">@</span>
            <input type="text" name="assigned_to" placeholder="Assigned to:" class="form-control" />
          </div>
        </div>

        <div class="col-12 mb-3">
          <textarea
            type="text"
            name="issue_text"
            placeholder="*Text"
            required
            class="form-control"
          ></textarea>
        </div>

        <div class="col-12 mb-3">
          <input type="text" name="status_text" placeholder="Status:" class="form-control" />
        </div>

        <div>
          <button type="submit" class="btn btn-primary col-12 mb-3">Submit Issue</button>
        </div>
      </form>
      <hr />

      <h1 class="display-6">Update issue on a project</h1>
      <p class="text-muted">(Change any or all to update issue on the _id and project supplied)</p>
      <form id="testForm2" class="row g-3">
        <div class="col-12 mb-3">
          <div class="input-group">
            <span class="input-group-text" id="basic-addon4"></span>
            <input
              type="text"
              class="form-control"
              id="basic-url"
              name="project"
              aria-describedby="basic-addon3"
              placeholder="project's name"
              required
            />
          </div>
        </div>
        <div class="col-12 mb-3">
          <input type="text" class="form-control" name="_id" placeholder="*_id" required />
        </div>
        <div class="col-12 mb-3">
          <input
            type="text"
            class="form-control"
            name="issue_title"
            placeholder="*Title"
            required
          />
        </div>

        <div class="col-md-6 mb-3">
          <div class="input-group">
            <span class="input-group-text">@</span>
            <input
              type="text"
              name="created_by"
              placeholder="*Created by:"
              required
              class="form-control"
            />
          </div>
        </div>

        <div class="col-md-6">
          <div class="input-group">
            <span class="input-group-text">@</span>
            <input type="text" name="assigned_to" placeholder="Assigned to:" class="form-control" />
          </div>
        </div>

        <div class="col-12 mb-3">
          <textarea
            type="text"
            name="issue_text"
            placeholder="*Text"
            required
            class="form-control"
          ></textarea>
        </div>

        <div class="col-12 mb-3">
          <input type="text" name="status_text" placeholder="Status:" class="form-control" />
        </div>

        <div>
          <button type="submit" class="btn btn-primary col-12 mb-3">Submit Issue</button>
        </div>
      </form>
      <hr />
      <h1 class="display-6">Delete issue on project</h1>
      <form id="testForm3">
        <div class="col-12 mb-4">
          <div class="input-group">
            <span class="input-group-text" id="basic-addon5"></span>
            <input
              type="text"
              class="form-control"
              id="basic-url"
              name="project"
              aria-describedby="basic-addon5"
              placeholder="project's name"
              required
            />
          </div>
        </div>
        <div class="col-12 mb-3">
          <input type="text" name="_id" placeholder="_id" class="form-control" required="" /><br />
        </div>
        <div>
          <button type="submit" class="btn btn-primary col-12 mb-3">Delete Issue</button>
        </div>
      </form>
      <code id="jsonResult"></code>
    </section>
    <!-- Your web-app is https, so your scripts need to be too -->
    <script
      src="https://code.jquery.com/jquery-2.2.1.min.js"
      integrity="sha256-gvQgAFzTH6trSrAWoH1iPo9Xc96QxSZ3feW6kem+O00="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
      integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
      crossorigin="anonymous"
    ></script>
    <script>
      $('#basic-addon3').text(window.location.href);
      $('#basic-addon4').text(window.location.href);
      $('#basic-addon5').text(window.location.href);
    </script>
    <script>
      $(function () {
        $('#testForm').submit(function (e) {
          $.ajax({
            url: `/api/issues/${$('#testForm').serializeArray()[0].value}`,
            type: 'post',
            data: $('#testForm').serialize(),
            success: function (data) {
              $('#jsonResult').text(JSON.stringify(data));
            },
          });
          e.preventDefault();
        });
        $('#testForm2').submit(function (e) {
          $.ajax({
            url: `/api/issues/${$('#testForm').serializeArray()[0].value}`,
            type: 'put',
            data: $('#testForm2').serialize(),
            success: function (data) {
              $('#jsonResult').text(JSON.stringify(data));
            },
          });
          e.preventDefault();
        });
        $('#testForm3').submit(function (e) {
          $.ajax({
            url: `/api/issues/${$('#testForm').serializeArray()[0].value}`,
            type: 'delete',
            data: $('#testForm3').serialize(),
            success: function (data) {
              $('#jsonResult').text(JSON.stringify(data));
            },
          });
          e.preventDefault();
        });
      });
    </script>
  </body>
</html>
